input {
    http {
        port => 9900
    }
    jdbc {
        jdbc_validate_connection => true
        jdbc_driver_library => "/usr/share/logstash/logstash-core/lib/jars/mysql-connector-j-8.0.33.jar"
        jdbc_driver_class => "com.mysql.cj.jdbc.Driver"
        jdbc_connection_string => "jdbc:mysql://host.docker.internal:3306/es_connect_db?serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true"
        jdbc_user => "root"
        jdbc_password => "1234"
        schedule => "*/1 * * * *"
        statement => "select * from loging"
    }
}

filter {
    mutate {
        add_field => {
            "doc_id" => "%{id}%{name}"
        }
    }
}

output {
    elasticsearch {
        index => "ksb-logs-%{+yyyy.MM.dd}"
        document_id => "%{doc_id}" # 데이터 중복 제거를 위함
        hosts => [ "host.docker.internal:9200" ]
    }
}